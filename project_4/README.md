# Project 4: Predict West Nile Virus

### Group 1:
### Gladys Pao, Fung Hok Yan (Ruby), Ew Chee Howe, Lim Jian Ann (John)
### SG-DSI-17

## Problem Statement

With the surge of the West Nile Virus in the city of Chicago, The Chicago Department of Public Health (CDPH) has decided to establish a comprehensive surveillance and control program to monitor the situation of the West Nile Virus epidemic in the city. The city officials from the CDPH's Disease And Treatment Agency have decided to step up control measures through the usage of fogging/pesticide coverage so as to control the outbreak of the West Nile Virus. With the purpose of controlling the epidemic, we have been hired by CDPH to analyse past data of West Nile Virus outbreaks, get insights on how to control this public health threat, and analyse the costs (as well as the benefits) on the usage of pesticide coverage for the control of West Nile Virus. Working with the data provided by the Disease And Treatment Agency, we will be predicting which areas are most likely to contain the West Nile Virus given their weather conditions and time variables. To choose our final classification model, we will be comparing the models' ROC_AUC scores (and recall rates if there are two or more models that performed similarly in the ROC_AUC metric).

Ultimately, we aim to provide a model that can accurately predict whether an area has the West Nile Virus, highlighting the most important conditions that leads to a higher probability of the West Nile Virus at a certain area/location. After gaining insights on the most important features as prioritised by the model, this will be followed by an in-depth cost and benefit analysis of pesticide coverage on certain WNV-predicted areas and then paired with recommendations for CDPH on suitable West Nile Virus control efforts in the city of Chicago; therefore helping CDPH in their West Nile Virus surveillance and control efforts in the city of Chicago.

## Executive Summary

With the rising public health threat of the West Nile Virus in the city of Chicago, the Chicago Department of Public Health (CDPH) has established a comprehensive surveillance and control program to monitor and manage the escalating situation. With CDPH's Disease And Treatment Agency moving to step up control measures through pesticide coverage/fogging, our team has been tasked to create a prediction model that predicts locations with West Nile Virus while also identifying conditions that leads to a higher probability of the virus. Through predictive modelling, areas with the presence of the West Nile Virus will be predicted and identified (with WNV-present denoted as 1 and WNV-absent denoted as 0) given certain weather and seasonal conditions.

Using the data we got from the city of Chicago, we cleaned and engineered the features to our suitability. After which, we fit the features into a logistic regression model as our baseline model, and compared the results with our other two classification models, Random Forest and XGBoost (executed with GridSearch for hyper-parameter tuning) for model selection purposes. As we are looking at binary classification, the models are evaluated based on the ROC_AUC metric (and then later on their recall rate to minimise false negatives since West Nile Virus is viewed as an increasing public health threat in Chicago). After comparing the ROC_AUC scores of both models with their recall rates, we have decided to choose the Random Forest model as our final prediction model.

Through exploratory data analysis and the study of our most important features as generated by our chosen model, we have found out that most features that highly affect the presence of West Nile Virus at a location are weather-related (e.g. temperature), location-related (e.g. near WNV hot spots) and season-related (i.e. months).

This is followed by recommendations for controlling the West Nile Virus epidemic in Chicago:
- Execute fogging/pesticide spraying on current West Nile Virus hot spots
- Consider fogging on areas that experience high temperatures during the summer
- Study and execute more research on mosquito species with higher probability of West Nile Virus
- Develop an app that highlights the current WNV hotspots
- Increase public awareness of West Nile Virus when the risk of contracting the virus is high
- Study and identify unknown mosquito species

Due to the high ROC_AUC and recall rates, we are highly confident that by adopting our model, the City of Chicago is able to identify potential WNV-present locations. By doing so, the city will be able to mitigate the spread of the WNV by targeting pesticide spraying efforts in these locations. Moving forward, the model can be continuously calibrated with more data so that that the model performance can improve overtime. Additional data related to various building information (e.g. drainage systems, pot holes, pools) can also be added to the model so as to provide us with insights on the breeding origin of the mosquitos while also improving the performance of the model. In the future, the model can potentially be utilised elsewhere to solve other social or business-related problems, such as by local shop owners to make informed restocking decisions on mosquito-repellent products, and public health researchers for West Nile Virus research-related purposes.


## Overview of Data
Source of data: https://www.kaggle.com/c/predict-west-nile-virus/<br>
The data dictionary can be downloaded or viewed here: https://www.kaggle.com/c/predict-west-nile-virus/data

## Data Dictionary

|**Feature**|Type|Description|
| :---|:---|:---|
|**date**|*obj*|Date that the WNV test is performed|
|**species**|*obj*|Species of mosquitos|
|**trap**|*obj*|Trap Id|
|**latitude**|*float*|Latitude of trap|
|**longitude**|*float*|Longitude of trap|
|**wnvpresent**|*int*|1 means WNV is present, and 0 means not present.|
|**nummosquitos**|*int*|Number of mosquitoes caught in this trap|
|**year**|*int*|Year that the WNV test is performed|
|**month**|*int*|Month that the WNV test is performed|
|**day**|*int*|Day that the WNV test is performed|
|**precip_avg**|*float*|Average precipitation from both weather stations|
|**14day_precip**|*float*|14 day average precipitation|
|**28day_precip**|*float*|28 day average precipitation|
|**90day_precip**|*float*|90 day average precipitation amount|
|**temp_avg**|*float*|Average temperature from both weather stations|
|**14day_tavg**|*float*|14 day average temperature|
|**28day_tavg**|*float*|28 day average temperature|
|**90day_tavg**|*float*|90 day average temperature|
|**tmin_avg**|*float*|Average minimum temperature from both weather stations|
|**14day_tmin**|*float*|14 day minimum temperature|
|**28day_tmin**|*float*|28 day minimum temperature|
|**tmax_avg**|*float*|Average maximum temperature from both weather stations|
|**14day_tmax**|*float*|14 day maximum temperature|
|**28day_tmax**|*float*|28 day maximum temperature|
|**dew_avg**|*float*|Average dew point from both weather stations|
|**14day_dew**|*float*|14 day average dew point|
|**28day_dew**|*float*|28 day average dew point|
|**day_sin**|*float*|Sine of day|
|**day_cos**|*float*|Cosine of day|
|**mth_sin**|*float*|Sine of month|
|**mth_cos**|*float*|Cosine of month|
|**tmax**|*float*|Maximum temperature at each trap on a particular day|
|**tmin**|*float*|Minimum temperature at each trap on a particular day|
|**tavg**|*float*|Average temperature at each trap on a particular day|
|**depart**|*float*|Departure from normal at each trap on a particular day|
|**dewpoint**|*float*|Dew point at each trap on a particular day|
|**wetbulb**|*float*|Wet bulb at each trap on a particular day|
|**heat**|*float*|Heating at each trap on a particular day|
|**cool**|*float*|Cooling at each trap on a particular day|
|**preciptotal**|*float*|Precipitation at each trap on a particular day|
|**stnpressure**|*float*|Station pressure at each trap on a particular day|
|**sealevel**|*float*|Sea level pressure at each trap on a particular day|
|**resultspeed**|*float*|Resultant wind speed at each trap on a particular day|
|**resultdir**|*float*|Resultant wind direction at each trap on a particular day|
|**avgspeed**|*float*|Average wind speed at each trap on a particular day|
|**daylight**|*float*|Time difference between sunrise and sunset at each trap on a particular day|
|**last_rained**|*int*|Days since last rained at each trap on a particular day|
|**tavgengineer**|*float*|Average temperature at each trap on a particular day|
|**dewpointengineer**|*float*|Average dew point^2|
|**wetbulbengineer**|*float*|Average wet bulb^2|
|**preciptotalengineer**|*float*|Total daily precipitation^2|
|**heatengineer**|*float*|Heating^2|
|**last_rainedengineer**|*float*|Days since last rained^2|
|**proba_wnv**|*float*|Probability of WNV presence|
|**proba_num**|*float*|Proportion of num of mosquitoes|
|**species_weights**|*float*|Species weights base on probability of WNV and proportion of num of mosquitoes|
|**month_weight**|*float*|Months weightage in terms of WNV positive found|
|**dead1**|*float*|Top deadliest hotspots for WNV positive|
|**dead2**|*float*|Second deadliest hotspots for WNV positive|
|**dead3**|*float*|Third deadliest hotspots for WNV positive|
|**dead4**|*float*|Forth deadliest hotspots for WNV positive|


## Cost-benefit Analysis

### Total spray cost

|Plan|Spray coverage|Area to be sprayed| x Cost per spray per km²| x Times of spraying| = Total spray cost|
|:---|:---|:---|:---|:---|:---|
|Plan 1|Spot 1|92.07 km²|USD 245.2|12|USD 270,906|
|Plan 2|Spot 1 + 2|128.8 km²|USD 245.2|12| USD 378,981|
|Plan 3|All 5 spots|187.68 km²|USD 245.2|12|USD 552,229|

We have listed out 3 plans for decision makers to choose depending on the resources available, for instance, budget and labour. If Chicago government is determined to strengthen the mosquito control and is willing to allocate more resources, plan 3 has the widest coverage for the presence of West Nile Virus in Chicago. 

In order to decide which plan to take, we will quantify the benefit of pesticide spraying to make a comparision between cost and benefit. 

### Cost-Benefit Analysis in Chicago

With reference to the information in Sacramento County, California in 2005, there was an outbreak of West Nile virus (WNV) disease occurred; 163 human cases were reported.

WNV disease in Sacramento County cost ≈ USD 2.28 million for medical treatment and patients’ productivity loss for both West Nile fever and West Nile neuroinvasive disease, which means 1 single case incurs loss of USD 18,276.

If Chicago government will choose Plan 3 to cover all 5 spots to spray, the total pesticide spraying cost is USD 552,229. To outweight this cost, the spray event would only need to prevent only 30 WNV disease cases in whole Chicago.The total cost of medical treatment and patients’ productivity loss can be avoided by conducting pesticide spraying (Avoided loss). After deducting the spraying cost, if it's positive, that is the potential benefit.

### Annual cost projections for various levels of pesticide coverage (cost) and the effect of these various levels of pesticide coverage (benefit) is shown below: 

|Chicago|WNV case number|Suggested plan|Avoided loss| - Spray cost| = Potential benefit|
|:---|:---|:---|:---|:---|:---|
|2010|47|Plan 3 All 5 spots|USD 858,972|USD 552,229|USD 306,743|
|2011|24|Plan 2 Spot 1 + 2 / further analysis|USD 438,624|USD 378,981|USD 59,643|
|2012|229|Plan 3 All 5 spots|USD 4,185,204|USD 552,229|USD 3,632,975|
|2013|66|Plan 3 All 5 spots|USD 1,206,216|USD 552,229|USD 653,987|
|2014|31|Plan 3 All 5 spots|USD 566,556|USD 552,229|USD 14,327|
|2015|36|Plan 3 All 5 spots|USD 657,936|USD 552,229|USD 105,707|
|2016|108|Plan 3 All 5 spots|USD 566,556|USD 552,229|USD 1,421,579|

Between 2010 to 2016, 6 years out of 7 have more than 30 cases. Hence, it is evident that the pesticide spraying is necessary to avoid the huge economic loss caused by WNV virus.

As long as the total WNV case number of the year is over 30, only conducting pesticide spraying with full coverage of all 5 spots with WNV presence will attain the maximum benefit.

If the total WNV case number of the year is below 30, Plan 1 or Plan 2 can be considered. But if we want to have a more precise target on the spray location, we can also carry out further analysis to find out which spots have the most dense distribution of WNV presence of the year. Even the coverge is less, but as long as we spot it accurately, we will still be able to conduct an effective mosquito control program.

The Cost-benefit analyis helps the Chicago Department of Public Health (CDPH) to decide when to spray, where to spray, how much it costs to carry out the spray and the potential benefit the spraying can bring. Apart from the Cost-benefit analysis, the model we developed and the analysis we conducted before have more than just single use. In the following, we will discuss about some recommendations. 


## Conclusion and Recommendations

### Recommendations
Based on our analysis, we have decided on the following recommendations for the Chicago Department of Public Health (CDPH):

1. <b>Execute fogging/pesticide spraying on current West Nile Virus hot spots</b><br>
Fogging should be implemented on current West Nile Virus hot spots since the hot spots have stayed consistent over the years. With the distance of a location to a hot spot being noted as an important feature, fogging on current hotspots can also help to curb the spread of the WNV to neighbouring areas.<br>

2. <b>Consider fogging on areas that experience high temperatures during the summer</b><br>
The CDPH should also consider fogging on other areas that are known to experience high temperatures (especially during the summer months) since high temperatures are known to cause a spike in West Nile Virus cases in a certain area. <br>

3. <b>Study and execute more research on mosquito species with higher probability of West Nile Virus</b><br>
Three mosquito species (Culex Pipiens, Culex Pipiens/Restuans and Culex Restuans) are calculated to have higher probability of contracting the West Nile Virus as opposed to the other mosquito species. More research should be made on the reason why these three species are more prone to the West Nile Virus, which will help the CDPH in their West Nile Virus control planning efforts.<br>

4. <b>Develop an app that highlights the current WNV hotspots</b><br>
Since WNV hotspots generally stay consistent for long periods of time, an app that maps current WNV hotspots can be developed so that citizens of Chicago would be able to refer to it anytime they would like.

5. <b>Increase public awareness of West Nile Virus when the risk of contracting the virus is high</b><br>
Since various weather-related and time-related conditions (e.g. month, temperature) are predicted to affect the presence of West Nile Virus at various locations, CDPH should make use of all new information gained from the our analysis to plan their public awareness efforts accordingly.

6. <b>Study and identify unknown mosquito species</b><br>
There are numerous species that are identified as 'unknown species' on the test dataset and hence, this method of data collection can highly induces bias in the predictive model. The unknown mosquito species should be studied and identified so as to reduce the bias of the predictive model and eventually help to improve the performance of the prediction model.<br>

### Conclusion

After comparing the performance of all models, we have decided to choose a Random Forest Classifier model for our West Nile Virus predictions due to its high ROC_AUC score (together with its high recall rate).

Through exploratory data analysis and the study of our most important features as generated by our chosen model, we have found out that most features that highly affect the presence of West Nile Virus at a location are:

- weather-related (e.g. temperature)
- location-related (e.g. near WNV hot spots)
- season-related (i.e. months)

This is followed by an in-depth cost-benefit analysis to quantify cost projections and analyse the effects of pesticide coverage. With the usage of this prediction model, the knowledge of important features that can affect the existence of West Nile Virus as well as the cost-benefit analysis of pesticide coverage, Chicago Department of Public Health can make use of these insights to incorporate appropriate measures in their West Nile Virus surveillance and control efforts in the city of Chicago.

Moving forward, the model should be continuously fed with more data so that that the model can continuously calibrate and improve overtime. Additional data related to various building information (e.g. drainage systems, pot holes, pools) should also be used and added to the model since it can provide us with insights on the breeding origin of the mosquitos and may even improve the performance of the model.

In the future, the model can potentially be utilised elsewhere to solve other social or business-related problems, such as by local shop owners to make informed restocking decisions on mosquito-repellent products, and public health researchers for West Nile Virus research-related purposes.
